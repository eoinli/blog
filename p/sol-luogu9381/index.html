<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content='width=device-width,initial-scale=1'><meta name=description content="来自 THUPC 2023 决赛的大模拟！"><title>「那些脑海里最珍贵的」题解</title>
<link rel=canonical href=https://eoin.blog/p/sol-luogu9381/><link rel=stylesheet href=/scss/style.min.5b67378878f34609120600e0f03f54ef00673042fa6572b2d4d38069dbfb89a6.css><meta property='og:title' content="「那些脑海里最珍贵的」题解"><meta property='og:description' content="来自 THUPC 2023 决赛的大模拟！"><meta property='og:url' content='https://eoin.blog/p/sol-luogu9381/'><meta property='og:site_name' content="Eoin Lee's Blog"><meta property='og:type' content='article'><meta property='article:section' content='Post'><meta property='article:tag' content='模拟'><meta property='article:published_time' content='2024-05-10T00:00:05+08:00'><meta property='article:modified_time' content='2024-05-10T00:00:05+08:00'><meta name=twitter:title content="「那些脑海里最珍贵的」题解"><meta name=twitter:description content="来自 THUPC 2023 决赛的大模拟！"><link rel="shortcut icon" href=/favicon.jpg><style>:root{--zh-font-family:"PingFang SC", "Source Han Sans SC VF",
      "Source Han Sans SC", "Noto Sans CJK SC", "Microsoft YaHei UI",
      "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif;--base-font-family:var(--sys-font-family), var(--zh-font-family),
      sans-serif, "Noto Color Emoji";--code-font-family:Menlo, Monaco, Consolas, "Courier New",
      var(--zh-font-family), monospace;--article-font-family:var(--base-font-family);font-optical-sizing:auto}</style><script>(function(){const t=document.createElement("link"),e=document.createElement("link"),n=document.createElement("link");t.rel="preconnect",t.href="https://fonts.googleapis.com",e.rel="preconnect",e.href="https://fonts.gstatic.com",e.crossOrigin="anonymous",n.rel="stylesheet",n.href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&display=swap",document.head.appendChild(t),document.head.appendChild(e),document.head.appendChild(n)})()</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu13c40bb6d89fba0f45d34b039ac03ece_1893705_300x0_resize_q75_box.jpeg width=300 height=301 class=site-logo loading=lazy alt=Avatar>
</a><span class=emoji>🇨🇳</span></figure><div class=site-meta><h1 class=site-name><a href=/>Eoin Lee's Blog</a></h1><h2 class=site-description>Collection of my everyday random thoughts.</h2></div></header><ol class=menu-social><li><a href=https://github.com/eoinli target=_blank title=GitHub rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 19c-4.3 1.4-4.3-2.5-6-3m12 5v-3.5c0-1 .1-1.4-.5-2 2.8-.3 5.5-1.4 5.5-6a4.6 4.6.0 00-1.3-3.2 4.2 4.2.0 00-.1-3.2s-1.1-.3-3.5 1.3a12.3 12.3.0 00-6.2.0C6.5 2.8 5.4 3.1 5.4 3.1a4.2 4.2.0 00-.1 3.2A4.6 4.6.0 004 9.5c0 4.6 2.7 5.7 5.5 6-.6.6-.6 1.2-.5 2V21"/></svg></a></li><li><a href=https://twitter.com/eoinlee target=_blank title=Twitter rel=me><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-twitter" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M22 4.01c-1 .49-1.98.689-3 .99-1.121-1.265-2.783-1.335-4.38-.737S11.977 6.323 12 8v1c-3.245.083-6.135-1.395-8-4 0 0-4.182 7.433 4 11-1.872 1.247-3.739 2.088-6 2 3.308 1.803 6.913 2.423 10.034 1.517 3.58-1.04 6.522-3.723 7.651-7.742a13.84 13.84.0 00.497-3.753C20.18 7.773 21.692 5.25 22 4.009z"/></svg></a></li><li><a href=https://www.youtube.com/@eoinleeee target=_blank title=YouTube rel=me><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-brand-youtube"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M2 8a4 4 0 014-4h12a4 4 0 014 4v8a4 4 0 01-4 4H6a4 4 0 01-4-4V8z"/><path d="M10 9l5 3-5 3z"/></svg></a></li></ol><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg>
<span>主页</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg>
<span>归档</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>
<span>搜索</span></a></li><li><a href=/projects/><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-bulb"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12h1m8-9v1m8 8h1M5.6 5.6l.7.7m12.1-.7-.7.7"/><path d="M9 16a5 5 0 116 0 3.5 3.5.0 00-1 3 2 2 0 01-4 0 3.5 3.5.0 00-1-3"/><path d="M9.7 17h4.6"/></svg>
<span>项目</span></a></li><li><a href=/friends/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-link" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M10 14a3.5 3.5.0 005 0l4-4a3.5 3.5.0 00-5-5l-.5.5"/><path d="M14 10a3.5 3.5.0 00-5 0l-4 4a3.5 3.5.0 005 5l.5-.5"/></svg>
<span>友链</span></a></li><li class=menu-bottom-section><ol class=menu><li id=i18n-switch><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-language" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 5h7"/><path d="M9 3v2c0 4.418-2.239 8-5 8"/><path d="M5 9c-.003 2.144 2.952 3.908 6.7 4"/><path d="M12 20l4-9 4 9"/><path d="M19.1 18h-6.2"/></svg>
<select name=language title=language onchange="window.location.href=this.selectedOptions[0].value"><option value=https://eoin.blog/ selected>简体中文</option><option value=https://eoin.blog/en/>English</option></select></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg>
<span>暗色模式</span></li></ol></li></ol></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#how-to-code>How to Code</a><ol><li><a href=#玩家信息输入>玩家信息输入</a></li><li><a href=#获取当前回合的攻击方队员编号>获取当前回合的攻击方队员编号</a></li><li><a href=#计算伤害>计算伤害</a></li><li><a href=#攻击>攻击</a></li><li><a href=#释放主动技能>释放主动技能</a></li><li><a href=#计算并施加被动技能>计算并施加被动技能</a></li><li><a href=#其他细节>其他细节</a></li></ol></li><li><a href=#code>Code</a></li><li><a href=#tips>Tips</a></li><li><a href=#epilogue>Epilogue</a></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/editorial/ style=background-color:#7469b6;color:#fff>题解</a></header><div class=article-title-wrapper><h2 class=article-title><a href=/p/sol-luogu9381/>「那些脑海里最珍贵的」题解</a></h2><h3 class=article-subtitle>来自 THUPC 2023 决赛的大模拟！</h3></div><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg>
<time class=article-time--published>May 10, 2024</time></div><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg>
<time class=article-time--reading>阅读时长: 17 分钟</time></div></footer></div></header><section class=article-content><p>这是笔者自己写的第一篇纯大模拟，因此本题的代码也是目前笔者写过最长的代码。</p><h2 id=how-to-code>How to Code</h2><p><del>依题意模拟即可。</del></p><p>本题除了模拟代码外几乎没有任何思维含量，纯纯的码力题，只要审题足够仔细并且有足够的耐心，A 掉这题是并不困难的。如果写大模拟的经验不是很足的话，看到题目甚至会无从下手（比如我）。这时候就最好从头到尾把题目读一遍，或者多读几遍，然后尽量顺着程序的大致运行过程开始编码。下面就跟着程序运行的逻辑顺序来一步一步实现代码。首先，规定一下本文中某些变量类型的替代称谓（C++11 语法）：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>using</span> <span class=n>f64</span> <span class=o>=</span> <span class=kt>double</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>str</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>MAP_SI</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>unordered_map</span><span class=o>&lt;</span><span class=n>str</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>MAP_II</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>unordered_map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span><span class=p>;</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=玩家信息输入>玩家信息输入</h3><p>首先，几乎可以完全确定的是，题目给定的数据全部都是有用的。所以输入的所有东西都要存储起来。并且，对于本题中这样有关 “队伍” 与 “玩家” 这样阵营分明的设定，我们可以几乎肯定地使用类（结构体）将同一实体有关的数值封装起来。这样就获得了我们的 <code>PLAYER</code> 类，用于存储一个玩家的全部有关信息。由于题目有关玩家信息的输入是以玩家为单位的，所以我们在该类中定义一个成员函数 <code>input()</code> 用于处理单个玩家信息的输入。当然，我们也需要将题目中涉及到的其他没有被输入的玩家属性存储到这个类中。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=n>member_cnt</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>PLAYER</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>team_fr</span><span class=p>;</span> <span class=c1>// 归属队伍
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>team_id</span><span class=p>;</span> <span class=c1>// 归属队伍内编号
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>type</span><span class=p>;</span> <span class=c1>// 类型：0 = weak, 1 = average, 2 = strong
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>lvl</span><span class=p>;</span> <span class=c1>// 等级：1 ~ 100
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>f64</span> <span class=n>atk</span><span class=p>;</span> <span class=c1>// 基础攻击力
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>f64</span> <span class=n>def</span><span class=p>;</span> <span class=c1>// 基础防御力
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 体力上限
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>act_skl</span><span class=p>;</span> <span class=c1>// 主动技能等级：0 ~ 5
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>psv_skl</span><span class=p>;</span> <span class=c1>// 被动技能等级：0 ~ 5
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>weapon_type</span><span class=p>;</span> <span class=c1>// 武器类型：0 = B, 1 = G, 2 = M
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>f64</span> <span class=n>weapon_atk</span><span class=p>;</span> <span class=c1>// 武器攻击力
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>hp</span><span class=p>;</span> <span class=c1>// 当前体力
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>bool</span> <span class=n>status</span><span class=p>;</span> <span class=c1>// 状态：0 = dead, 1 = alive
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>f64</span> <span class=n>skl_boost</span><span class=p>;</span> <span class=c1>// 技能加成
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>input</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>player_type</span><span class=p>[</span><span class=mi>10</span><span class=p>],</span> <span class=n>weapon_type_t</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%s Lv=%d maxhp=%d atk=%lf def=%lf skillLv=%d passivesklLv=%d %s weaponatk=%lf</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>player_type</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>lvl</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>max_hp</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>atk</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>def</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>act_skl</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>psv_skl</span><span class=p>,</span> <span class=n>weapon_type_t</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>weapon_atk</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>hp</span> <span class=o>=</span> <span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 初始生命值为上限
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>status</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span> <span class=c1>// 初始角色未倒下
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>skl_boost</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// 初始技能加成为 1
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>type</span> <span class=o>=</span> <span class=n>PLAYER_TYPE</span><span class=p>[</span><span class=n>str</span><span class=p>(</span><span class=n>player_type</span><span class=p>)];</span> <span class=c1>// 根据输入获取角色类型对应数字
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>weapon_type</span> <span class=o>=</span> <span class=n>WEAPON_TYPE</span><span class=p>[</span><span class=n>str</span><span class=p>(</span><span class=n>weapon_type_t</span><span class=p>)];</span> <span class=c1>// 根据输入获取武器类型对应数字
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=n>team</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=mi>7</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d %d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>member_cnt</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=o>&amp;</span><span class=n>member_cnt</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 输入南队队员
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>input</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>team_fr</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>team_id</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 输入北队队员
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>input</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>team_fr</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>team_id</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>为了方便，我们将输入的字符串属性转换成数字，存储在一个常量哈希表中（详见文末代码部分）。</p><h3 id=获取当前回合的攻击方队员编号>获取当前回合的攻击方队员编号</h3><p>通过阅读题面，我们可以知道，每一轮的攻击方（或技能施放方，以下我们将一回合内主动进行操作的一队统称为攻击方队伍）队伍是根据回合数确定的，攻击方队伍中的攻击者是根据队员编号进行选择的。</p><p>为了追踪两队的攻击队员，我们定义数组 <code>attacker[2]</code>，分别存储两队当前的攻击队员编号。接着，为了根据题目含义确定每一回合的攻击队员，我们定义 <code>get_attacker()</code> 函数：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=n>attacker</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>/// @brief 计算每一回合攻击方队伍的攻击者
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t 攻击方队伍的编号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=nf>get_attacker</span><span class=p>(</span><span class=kt>int</span> <span class=n>t</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=o>++</span><span class=n>attacker</span><span class=p>[</span><span class=n>t</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>attacker</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>member_cnt</span><span class=p>[</span><span class=n>t</span><span class=p>])</span> <span class=n>attacker</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>attacker</span><span class=p>[</span><span class=n>t</span><span class=p>]].</span><span class=n>status</span><span class=p>);</span> <span class=c1>// 如果找到未倒下的角色就跳出循环
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 由于题目保证所有操作合法，所以不用担心死循环
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>为了确定每一个回合是哪一队进行攻击，我们在每次循环开头执行以下代码。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=kt>int</span> <span class=n>round_cnt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>round_cnt</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>RND</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>RND</span> <span class=o>&lt;=</span> <span class=n>round_cnt</span><span class=p>;</span> <span class=o>++</span><span class=n>RND</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>t_a</span> <span class=o>=</span> <span class=p>(</span><span class=n>RND</span> <span class=o>%</span> <span class=mi>2</span><span class=p>)</span> <span class=o>^</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// 计算攻击方队伍
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>int</span> <span class=n>t_b</span> <span class=o>=</span> <span class=p>(</span><span class=n>RND</span> <span class=o>%</span> <span class=mi>2</span><span class=p>);</span> <span class=c1>// 计算防御方队伍
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// 获取攻击方队伍的当前攻击者
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>get_attacker</span><span class=p>(</span><span class=n>t_a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>active</span> <span class=o>=</span> <span class=n>attacker</span><span class=p>[</span><span class=n>t_a</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=计算伤害>计算伤害</h3><p>伤害计算是施放攻击对敌人造成影响的重要要素。因此这一部分需要作为铺垫并率先考虑。根据题目中描述：</p><blockquote><p>「伤害」，即「体力值」减少的量，由「攻击强度」和受到「伤害」的人的「防御指数」决定。</p></blockquote><p>攻击强度是由攻击队员的各项数值确定的，最终扣血的数值通过受攻击队员的相关防御指数确定。可见，计算完的攻击强度是沟通施放伤害与承受伤害的桥梁。因此我们将计算完的攻击强度作为一个整体，对于单个队员实施扣血操作。为此，我们在 <code>PLAYER</code> 类中定义 <code>deal_damage()</code> 函数，用于根据当前角色受到攻击的强度来确定扣血的数值。同时，由于攻击强度的计算以及扣血数值的计算都需要用到以队伍为单位的攻击加成和防御加成，所以我们也需要定义这两个浮点型变量 <code>atk_boost[2]</code> 和 <code>def_boost[2]</code>。由于这两个数值最终是乘到计算中的，所以初始值需要赋值为 1。</p><p>在扣血的时候，需要额外注意输出答案中的伤害大小是<strong>原始数值</strong>，但角色实际扣血是不能扣成负数的。其他扣血的地方也是同理。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=n>f64</span> <span class=n>atk_boost</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>f64</span> <span class=n>def_boost</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>PLAYER</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>deal_damage</span><span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=p>,</span> <span class=n>f64</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>/// @brief 根据攻击强度对当前角色进行扣血
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t_a 攻击方队伍的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param act 攻击者在攻击方队伍内的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param eff 攻击强度
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=n>PLAYER</span><span class=o>::</span><span class=n>deal_damage</span><span class=p>(</span><span class=kt>int</span> <span class=n>t_a</span><span class=p>,</span> <span class=kt>int</span> <span class=n>act</span><span class=p>,</span> <span class=n>f64</span> <span class=n>eff</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>status</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span> <span class=c1>// 保险措施，如果已经倒下就不用考虑了
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>dmg</span> <span class=o>=</span> <span class=n>eff</span> <span class=o>/</span> <span class=p>(</span><span class=n>def</span> <span class=o>*</span> <span class=n>def_boost</span><span class=p>[</span><span class=n>team_fr</span><span class=p>]);</span> <span class=c1>// 计算攻击产生扣血的有效值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>hp</span> <span class=o>-=</span> <span class=n>dmg</span><span class=p>;</span> <span class=c1>// 扣血
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 如果扣血后角色生命值不高于 0，则该角色倒下
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>hp</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>hp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>status</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span> <span class=c1>// 设定角色状态为倒下
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%s %d took %d damage from %s %d -&gt; %d/%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=n>team_fr</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>team_id</span><span class=p>,</span> <span class=n>dmg</span><span class=p>,</span> <span class=p>(</span><span class=n>t_a</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>act</span><span class=p>,</span> <span class=n>hp</span><span class=p>,</span> <span class=n>max_hp</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=攻击>攻击</h3><p>由题面我们可以知道，攻击分四种：普通攻击和三种特殊攻击。阅读题面不难发现，这四种攻击中，只跟攻击队员相关的属性加成，以及跟受攻击队员的躲闪位置有关的方位加成，对于任何一种攻击都是相同的，所以我们先预处理出这一部分属性的加成。普通攻击和 B 特殊攻击比较简单，直接调用受攻击者的 <code>deal_damage()</code> 函数，并传入计算好的攻击强度值即可。G 攻击和 M 攻击属于 AoE 攻击，与受攻击队员的站位有关，因此我们先根据题目要求定义两个数组（我不知道为什么我要用一个哈希表）<code>PLACE[]</code> 和 <code>INIT_INDEX[]</code>，分别存储队员的站位顺序和每一个队员在队伍中的位置编号，这两个数组的信息是互为键值的。由此我们就可以获取 AoE 攻击中受攻击的队员了。接下来依题意模拟即可。</p><p>需要注意的是，在 AoE 伤害中，虽然攻击强度中的方位加成是按照主要被攻击者的躲闪方位来计算的，但种族加成是按照受到攻击的实体本身的种族来计算的，所以这一部分需要单独考虑，这也是我把种族加成从预处理中孤立出来的一个主要因素。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>PLACE</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>5</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>6</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>MAP_II</span> <span class=n>INIT_INDEX</span> <span class=o>=</span> <span class=p>{{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>},</span> <span class=p>{</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>},</span> <span class=p>{</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>},</span> <span class=p>{</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>},</span> <span class=p>{</span><span class=mi>5</span><span class=p>,</span> <span class=mi>0</span><span class=p>},</span> <span class=p>{</span><span class=mi>6</span><span class=p>,</span> <span class=mi>5</span><span class=p>}};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>/// @brief 实施普通攻击和特殊攻击
</span></span></span><span class=line><span class=cl><span class=c1>/// @param atk_p 攻击位置
</span></span></span><span class=line><span class=cl><span class=c1>/// @param ddg_p 躲闪位置
</span></span></span><span class=line><span class=cl><span class=c1>/// @param act 攻击者在攻击方队伍内的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param trg 防御者在防御方队伍内的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t_a 攻击方队伍编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t_b 防御方队伍编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param type 攻击类型，-1 为普通攻击，0~2 为对应的特殊攻击
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=nf>perform_attack</span><span class=p>(</span><span class=kt>int</span> <span class=n>atk_p</span><span class=p>,</span> <span class=kt>int</span> <span class=n>ddg_p</span><span class=p>,</span> <span class=kt>int</span> <span class=n>act</span><span class=p>,</span> <span class=kt>int</span> <span class=n>trg</span><span class=p>,</span> <span class=kt>int</span> <span class=n>t_a</span><span class=p>,</span> <span class=kt>int</span> <span class=n>t_b</span><span class=p>,</span> <span class=kt>int</span> <span class=n>type</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 由于 G 和 M 类型的种族加成对不同目标有不同的取值，所以预处理时不包含种族加成
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>f64</span> <span class=n>eff</span> <span class=o>=</span> <span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>atk</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>weapon_atk</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>skl_boost</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>        <span class=n>atk_boost</span><span class=p>[</span><span class=n>t_a</span><span class=p>]</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>        <span class=n>LOC_BOOST</span><span class=p>[(</span><span class=n>atk_p</span> <span class=o>-</span> <span class=n>ddg_p</span> <span class=o>+</span> <span class=mi>6</span><span class=p>)</span> <span class=o>%</span> <span class=mi>6</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 普通攻击
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>type</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// B 型特殊攻击
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>type</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=mf>1.25</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 预处理 G 和 M 类型特殊 AoE 攻击的范围
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>trg_l</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>trg_r</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 西边第一个未倒下的角色
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>INIT_INDEX</span><span class=p>[</span><span class=n>trg</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=o>--</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>PLACE</span><span class=p>[</span><span class=n>i</span><span class=p>]].</span><span class=n>status</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>trg_l</span> <span class=o>=</span> <span class=n>PLACE</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 东边第一个未倒下的角色
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>INIT_INDEX</span><span class=p>[</span><span class=n>trg</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>6</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>PLACE</span><span class=p>[</span><span class=n>i</span><span class=p>]].</span><span class=n>status</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>trg_r</span> <span class=o>=</span> <span class=n>PLACE</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// G 型特殊攻击
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>type</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>cand_cnt</span> <span class=o>=</span> <span class=p>(</span><span class=n>trg_l</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>trg_r</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>f64</span> <span class=n>mul</span> <span class=o>=</span> <span class=mf>1.35</span> <span class=o>/</span> <span class=n>cand_cnt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=n>mul</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>trg_l</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_l</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=n>mul</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_l</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>trg_r</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_r</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=n>mul</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_r</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// M 型特殊攻击
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>type</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=mf>1.15</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>trg_l</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_l</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=mf>0.23</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_l</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>trg_r</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_r</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=mf>0.23</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_r</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>RND</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>RND</span> <span class=o>&lt;=</span> <span class=n>round_cnt</span><span class=p>;</span> <span class=o>++</span><span class=n>RND</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>action_type</span><span class=p>[</span><span class=mi>20</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>trg</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%s target=%d &#34;</span><span class=p>,</span> <span class=n>action_type</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>trg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 施放普通攻击
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>str</span><span class=p>(</span><span class=n>action_type</span><span class=p>)</span> <span class=o>==</span> <span class=s>&#34;Basicattack&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>atk_p</span><span class=p>,</span> <span class=n>ddg_p</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;atkpos=%d ddgpos=%d </span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>atk_p</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>ddg_p</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>perform_attack</span><span class=p>(</span><span class=n>atk_p</span><span class=p>,</span> <span class=n>ddg_p</span><span class=p>,</span> <span class=n>active</span><span class=p>,</span> <span class=n>trg</span><span class=p>,</span> <span class=n>t_a</span><span class=p>,</span> <span class=n>t_b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>active</span><span class=p>].</span><span class=n>skl_boost</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// 施放攻击之后重置技能加成
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 施放特殊攻击
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>str</span><span class=p>(</span><span class=n>action_type</span><span class=p>)</span> <span class=o>==</span> <span class=s>&#34;Specialattack&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>atk_p</span><span class=p>,</span> <span class=n>ddg_p</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;atkpos=%d ddgpos=%d </span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>atk_p</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>ddg_p</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>perform_attack</span><span class=p>(</span><span class=n>atk_p</span><span class=p>,</span> <span class=n>ddg_p</span><span class=p>,</span> <span class=n>active</span><span class=p>,</span> <span class=n>trg</span><span class=p>,</span> <span class=n>t_a</span><span class=p>,</span> <span class=n>t_b</span><span class=p>,</span> <span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>active</span><span class=p>].</span><span class=n>weapon_type</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>active</span><span class=p>].</span><span class=n>skl_boost</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// 施放攻击之后重置技能加成
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>putchar</span><span class=p>(</span><span class=sc>&#39;\n&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=释放主动技能>释放主动技能</h3><p>由于技能部分涉及到了很多常数，所以我们不如先把所有数值存起来。这个时候就体现出将字符串属性存储为整数的优越之处了。注意我的存法中，还包含了技能等级为 0 时的加成，虽然可能用不到，但还是存一下比较保险。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>const</span> <span class=n>f64</span> <span class=n>ACT_SKL_MUL</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=mf>0.00</span><span class=p>,</span> <span class=mf>0.10</span><span class=p>,</span> <span class=mf>0.12</span><span class=p>,</span> <span class=mf>0.15</span><span class=p>,</span> <span class=mf>0.17</span><span class=p>,</span> <span class=mf>0.20</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=mf>0.00</span><span class=p>,</span> <span class=mf>0.06</span><span class=p>,</span> <span class=mf>0.07</span><span class=p>,</span> <span class=mf>0.08</span><span class=p>,</span> <span class=mf>0.09</span><span class=p>,</span> <span class=mf>0.10</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=mf>1.00</span><span class=p>,</span> <span class=mf>2.10</span><span class=p>,</span> <span class=mf>2.17</span><span class=p>,</span> <span class=mf>2.24</span><span class=p>,</span> <span class=mf>2.32</span><span class=p>,</span> <span class=mf>2.40</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>f64</span> <span class=n>PSV_SKL_MUL</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=mf>0.00</span><span class=p>,</span> <span class=mf>0.013</span><span class=p>,</span> <span class=mf>0.016</span><span class=p>,</span> <span class=mf>0.019</span><span class=p>,</span> <span class=mf>0.022</span><span class=p>,</span> <span class=mf>0.025</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=mf>0.00</span><span class=p>,</span> <span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.02</span><span class=p>,</span> <span class=mf>0.03</span><span class=p>,</span> <span class=mf>0.04</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=mf>0.00</span><span class=p>,</span> <span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.02</span><span class=p>,</span> <span class=mf>0.03</span><span class=p>,</span> <span class=mf>0.04</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></td></tr></table></div></div><p>有关主动技能，有几点值得注意。</p><p>第一是 Weak 类型的主动技能，技能释放的对象是本队成员，所以在传入参数的时候，目标队伍需要设定为本队。在回复生命的时候，需要额外注意输出答案中的回复量大小是<strong>原始数值</strong>，但角色实际回复生命是不能超过上限的。其他回复生命的地方也是同理。</p><p>第二是 Average 类型的主动技能，会给对方施加 DoT 持续伤害并在<strong>技能释放者所在队伍的主动回合的回合末</strong>进行结算。由于 DoT 伤害一旦施加，就只与被施加的敌方队员有关了，所以我们在 <code>PLAYER</code> 类中对有关 DoT 伤害的信息进行存储，并定义函数 <code>DOT()</code>，在每一个生效回合末激活。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=k>struct</span> <span class=nc>PLAYER</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>dot_dmg</span><span class=p>;</span> <span class=c1>// 持续伤害大小
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>dot_rounds</span><span class=p>;</span> <span class=c1>// 持续伤害层数
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>DOT</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=n>team</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=mi>7</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>/// @brief DoT，即 Damage over Time，处理当前角色受到的 Average 类型的持续伤害
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=n>PLAYER</span><span class=o>::</span><span class=n>DOT</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>status</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span> <span class=c1>// 保险措施，如果已经倒下就不用考虑了
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>dot_rounds</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 如果持续伤害层数不为 0
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=o>--</span><span class=n>dot_rounds</span><span class=p>,</span> <span class=n>hp</span> <span class=o>-=</span> <span class=n>dot_dmg</span><span class=p>;</span> <span class=c1>// 则触发一次持续伤害并减一层层数
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// 同上
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>hp</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>hp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>status</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>void</span> <span class=nf>input</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>dot_rounds</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// 初始持续伤害剩余层数为 0
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>dot_dmg</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// 初始持续伤害大小为 0
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%s %d took %d damage from skill -&gt; %d/%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=n>team_fr</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>team_id</span><span class=p>,</span> <span class=n>dot_dmg</span><span class=p>,</span> <span class=n>hp</span><span class=p>,</span> <span class=n>max_hp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>那么接下来就可以写处理主动技能释放的函数了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=c1>/// @brief 触发主动技能
</span></span></span><span class=line><span class=cl><span class=c1>/// @param act 释放技能者在释放技能方队伍内的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param trg 被释放技能者在被释放技能方队伍内的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t_a 释放技能方队伍的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t_b 被释放技能队伍的编号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=nf>activate_active_skill</span><span class=p>(</span><span class=kt>int</span> <span class=n>act</span><span class=p>,</span> <span class=kt>int</span> <span class=n>trg</span><span class=p>,</span> <span class=kt>int</span> <span class=n>t_a</span><span class=p>,</span> <span class=kt>int</span> <span class=n>t_b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 获取技能类型名以便输出
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>str</span> <span class=n>skl_type</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=n>skl_type</span> <span class=o>=</span> <span class=s>&#34;Weak&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=n>skl_type</span> <span class=o>=</span> <span class=s>&#34;Average&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span> <span class=n>skl_type</span> <span class=o>=</span> <span class=s>&#34;Strong&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%s %d applied %s skill to %s %d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=n>t_a</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>act</span><span class=p>,</span> <span class=n>skl_type</span><span class=p>.</span><span class=n>c_str</span><span class=p>(),</span> <span class=p>(</span><span class=n>t_b</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>trg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 对于 Weak 类型的主动技能
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>hp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>heal</span> <span class=o>=</span> <span class=n>ACT_SKL_MUL</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>act_skl</span><span class=p>]</span> <span class=o>*</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 计算回复量
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>hp</span> <span class=o>+=</span> <span class=n>heal</span><span class=p>;</span> <span class=c1>// 回复
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>hp</span> <span class=o>&gt;</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>max_hp</span><span class=p>)</span> <span class=c1>// 如果回复后超过生命上限
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>hp</span> <span class=o>=</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 则将生命值改为上限
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>tmp</span> <span class=o>!=</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>hp</span><span class=p>)</span> <span class=c1>// 如果生命值有所变动，就需要输出
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%s %d recovered +%d hp -&gt; %d/%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>t_b</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>trg</span><span class=p>,</span> <span class=n>heal</span><span class=p>,</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>hp</span><span class=p>,</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>max_hp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 对于 Average 类型的主动技能
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>dot_rounds</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span> <span class=c1>// 设持续伤害持续 3 层
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>dot_dmg</span> <span class=o>=</span> <span class=n>ACT_SKL_MUL</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>act_skl</span><span class=p>]</span> <span class=o>*</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 计算持续伤害大小
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 对于 Strong 类型的主动技能
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>skl_boost</span> <span class=o>=</span> <span class=n>ACT_SKL_MUL</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>act_skl</span><span class=p>];</span> <span class=c1>// 更改角色的技能加成
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>RND</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>RND</span> <span class=o>&lt;=</span> <span class=n>round_cnt</span><span class=p>;</span> <span class=o>++</span><span class=n>RND</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>// ...
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// 施放主动技能
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>str</span><span class=p>(</span><span class=n>action_type</span><span class=p>)</span> <span class=o>==</span> <span class=s>&#34;Skill&#34;</span><span class=p>)</span> <span class=c1>// 只有 Average 类型的主动技能是对敌方的
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>activate_active_skill</span><span class=p>(</span><span class=n>active</span><span class=p>,</span> <span class=n>trg</span><span class=p>,</span> <span class=n>t_a</span><span class=p>,</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>active</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>?</span> <span class=nl>t_b</span> <span class=p>:</span> <span class=n>t_a</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 对防守方队伍中所有收到持续伤害的队员结算持续伤害（同队施放的持续伤害只在同队为攻击方的回合内生效）
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=n>t_b</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>DOT</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>putchar</span><span class=p>(</span><span class=sc>&#39;\n&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=计算并施加被动技能>计算并施加被动技能</h3><p>被动技能是本题主要的坑点之一，虽然题目已经说明，但还是很容易漏写。在角色倒下时，该角色给己方队伍贡献的被动技能数值需要重新计算。每回合开始时，还需要处理 Weak 类型的被动技能对己方队伍成员的生命值回复。因此我们写一个专门的函数 <code>reapply_passive_skills()</code>，在每次需要重新计算被动技能时，整体全部统计一遍。（反正数据范围小，复杂度再高也没什么问题。）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=c1>/// @brief 在每回合开始时及有角色倒下后重新计算被动伤害
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t 默认为 -1，有角色倒下；如果输入为 0 或 1，则代表 Weak 类型的被动技能生效的团队
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=nf>reapply_passive_skills</span><span class=p>(</span><span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>t</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 如果是开局，则需要使 Weak 类型的被动效果生效
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f64</span> <span class=n>weak</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// 统计 Weak 被动叠加效果层数
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=n>t</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>status</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>                <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=c1>// 对于当前队伍中所有还活着的 Weak 类型角色
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=n>weak</span> <span class=o>+=</span> <span class=n>PSV_SKL_MUL</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>psv_skl</span><span class=p>];</span> <span class=c1>// 根据其等级叠加效果加成
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>weak</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>min</span><span class=p>(</span><span class=n>weak</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>);</span> <span class=c1>// 考虑效果加成上限
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=n>t</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>status</span><span class=p>)</span> <span class=k>continue</span><span class=p>;</span> <span class=c1>// 已经倒下的角色就不用考虑了
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>heal</span> <span class=o>=</span> <span class=n>weak</span> <span class=o>*</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 计算回复量
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span> <span class=o>+=</span> <span class=n>heal</span><span class=p>;</span> <span class=c1>// 回复
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span> <span class=o>&gt;</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>max_hp</span><span class=p>)</span> <span class=c1>// 如果回复后超过生命上限
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span> <span class=o>=</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 则将生命值更改为上限
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>tmp</span> <span class=o>!=</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span><span class=p>)</span> <span class=c1>// 如果生命值有所变动，就需要输出
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%s %d recovered +%d hp -&gt; %d/%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=n>t</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>i</span><span class=p>,</span> <span class=n>heal</span><span class=p>,</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span><span class=p>,</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>max_hp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 对于其他两种类型，只需要在角色倒下后考虑被动技能分配情况即可
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>t</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>;</span> <span class=o>++</span><span class=n>t</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>f64</span> <span class=n>average</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>strong</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// 统计被动效果叠加层数
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=n>t</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>status</span><span class=p>)</span> <span class=c1>// 对于当前队伍中所有还活着的对应类型队员
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=c1>// 统计 Average 被动叠加层数
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=n>average</span> <span class=o>+=</span> <span class=n>PSV_SKL_MUL</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>psv_skl</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span> <span class=c1>// 统计 Strong 被动叠加层数
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=n>strong</span> <span class=o>+=</span> <span class=n>PSV_SKL_MUL</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>psv_skl</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 根据上限进行相应调整
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>average</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>min</span><span class=p>(</span><span class=n>average</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>strong</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>min</span><span class=p>(</span><span class=n>strong</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 增加对应的防御加成、攻击加成的值
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>def_boost</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>=</span> <span class=n>average</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>atk_boost</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>=</span> <span class=n>strong</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>将这个函数添加到每回合开始时以及有角色倒下后即可。</p><h3 id=其他细节>其他细节</h3><p>比如回合末信息的输出和最后赢家的判定。这些小细节就请看下面的完整代码了。</p><h2 id=code>Code</h2><p>以下代码建议使用 Visual Studio Code 或者其他功能较丰富的编辑器打开预览，因为我在部分函数上添加了 Doxygen 注释，以便增强代码可读性，即使已经没有什么可读性可言了。但一定不要复制粘贴提交，一定要自己写一遍！</p><details><summary>点击浏览全部代码（共 360 行，含注释）</summary><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>  1
</span><span class=lnt>  2
</span><span class=lnt>  3
</span><span class=lnt>  4
</span><span class=lnt>  5
</span><span class=lnt>  6
</span><span class=lnt>  7
</span><span class=lnt>  8
</span><span class=lnt>  9
</span><span class=lnt> 10
</span><span class=lnt> 11
</span><span class=lnt> 12
</span><span class=lnt> 13
</span><span class=lnt> 14
</span><span class=lnt> 15
</span><span class=lnt> 16
</span><span class=lnt> 17
</span><span class=lnt> 18
</span><span class=lnt> 19
</span><span class=lnt> 20
</span><span class=lnt> 21
</span><span class=lnt> 22
</span><span class=lnt> 23
</span><span class=lnt> 24
</span><span class=lnt> 25
</span><span class=lnt> 26
</span><span class=lnt> 27
</span><span class=lnt> 28
</span><span class=lnt> 29
</span><span class=lnt> 30
</span><span class=lnt> 31
</span><span class=lnt> 32
</span><span class=lnt> 33
</span><span class=lnt> 34
</span><span class=lnt> 35
</span><span class=lnt> 36
</span><span class=lnt> 37
</span><span class=lnt> 38
</span><span class=lnt> 39
</span><span class=lnt> 40
</span><span class=lnt> 41
</span><span class=lnt> 42
</span><span class=lnt> 43
</span><span class=lnt> 44
</span><span class=lnt> 45
</span><span class=lnt> 46
</span><span class=lnt> 47
</span><span class=lnt> 48
</span><span class=lnt> 49
</span><span class=lnt> 50
</span><span class=lnt> 51
</span><span class=lnt> 52
</span><span class=lnt> 53
</span><span class=lnt> 54
</span><span class=lnt> 55
</span><span class=lnt> 56
</span><span class=lnt> 57
</span><span class=lnt> 58
</span><span class=lnt> 59
</span><span class=lnt> 60
</span><span class=lnt> 61
</span><span class=lnt> 62
</span><span class=lnt> 63
</span><span class=lnt> 64
</span><span class=lnt> 65
</span><span class=lnt> 66
</span><span class=lnt> 67
</span><span class=lnt> 68
</span><span class=lnt> 69
</span><span class=lnt> 70
</span><span class=lnt> 71
</span><span class=lnt> 72
</span><span class=lnt> 73
</span><span class=lnt> 74
</span><span class=lnt> 75
</span><span class=lnt> 76
</span><span class=lnt> 77
</span><span class=lnt> 78
</span><span class=lnt> 79
</span><span class=lnt> 80
</span><span class=lnt> 81
</span><span class=lnt> 82
</span><span class=lnt> 83
</span><span class=lnt> 84
</span><span class=lnt> 85
</span><span class=lnt> 86
</span><span class=lnt> 87
</span><span class=lnt> 88
</span><span class=lnt> 89
</span><span class=lnt> 90
</span><span class=lnt> 91
</span><span class=lnt> 92
</span><span class=lnt> 93
</span><span class=lnt> 94
</span><span class=lnt> 95
</span><span class=lnt> 96
</span><span class=lnt> 97
</span><span class=lnt> 98
</span><span class=lnt> 99
</span><span class=lnt>100
</span><span class=lnt>101
</span><span class=lnt>102
</span><span class=lnt>103
</span><span class=lnt>104
</span><span class=lnt>105
</span><span class=lnt>106
</span><span class=lnt>107
</span><span class=lnt>108
</span><span class=lnt>109
</span><span class=lnt>110
</span><span class=lnt>111
</span><span class=lnt>112
</span><span class=lnt>113
</span><span class=lnt>114
</span><span class=lnt>115
</span><span class=lnt>116
</span><span class=lnt>117
</span><span class=lnt>118
</span><span class=lnt>119
</span><span class=lnt>120
</span><span class=lnt>121
</span><span class=lnt>122
</span><span class=lnt>123
</span><span class=lnt>124
</span><span class=lnt>125
</span><span class=lnt>126
</span><span class=lnt>127
</span><span class=lnt>128
</span><span class=lnt>129
</span><span class=lnt>130
</span><span class=lnt>131
</span><span class=lnt>132
</span><span class=lnt>133
</span><span class=lnt>134
</span><span class=lnt>135
</span><span class=lnt>136
</span><span class=lnt>137
</span><span class=lnt>138
</span><span class=lnt>139
</span><span class=lnt>140
</span><span class=lnt>141
</span><span class=lnt>142
</span><span class=lnt>143
</span><span class=lnt>144
</span><span class=lnt>145
</span><span class=lnt>146
</span><span class=lnt>147
</span><span class=lnt>148
</span><span class=lnt>149
</span><span class=lnt>150
</span><span class=lnt>151
</span><span class=lnt>152
</span><span class=lnt>153
</span><span class=lnt>154
</span><span class=lnt>155
</span><span class=lnt>156
</span><span class=lnt>157
</span><span class=lnt>158
</span><span class=lnt>159
</span><span class=lnt>160
</span><span class=lnt>161
</span><span class=lnt>162
</span><span class=lnt>163
</span><span class=lnt>164
</span><span class=lnt>165
</span><span class=lnt>166
</span><span class=lnt>167
</span><span class=lnt>168
</span><span class=lnt>169
</span><span class=lnt>170
</span><span class=lnt>171
</span><span class=lnt>172
</span><span class=lnt>173
</span><span class=lnt>174
</span><span class=lnt>175
</span><span class=lnt>176
</span><span class=lnt>177
</span><span class=lnt>178
</span><span class=lnt>179
</span><span class=lnt>180
</span><span class=lnt>181
</span><span class=lnt>182
</span><span class=lnt>183
</span><span class=lnt>184
</span><span class=lnt>185
</span><span class=lnt>186
</span><span class=lnt>187
</span><span class=lnt>188
</span><span class=lnt>189
</span><span class=lnt>190
</span><span class=lnt>191
</span><span class=lnt>192
</span><span class=lnt>193
</span><span class=lnt>194
</span><span class=lnt>195
</span><span class=lnt>196
</span><span class=lnt>197
</span><span class=lnt>198
</span><span class=lnt>199
</span><span class=lnt>200
</span><span class=lnt>201
</span><span class=lnt>202
</span><span class=lnt>203
</span><span class=lnt>204
</span><span class=lnt>205
</span><span class=lnt>206
</span><span class=lnt>207
</span><span class=lnt>208
</span><span class=lnt>209
</span><span class=lnt>210
</span><span class=lnt>211
</span><span class=lnt>212
</span><span class=lnt>213
</span><span class=lnt>214
</span><span class=lnt>215
</span><span class=lnt>216
</span><span class=lnt>217
</span><span class=lnt>218
</span><span class=lnt>219
</span><span class=lnt>220
</span><span class=lnt>221
</span><span class=lnt>222
</span><span class=lnt>223
</span><span class=lnt>224
</span><span class=lnt>225
</span><span class=lnt>226
</span><span class=lnt>227
</span><span class=lnt>228
</span><span class=lnt>229
</span><span class=lnt>230
</span><span class=lnt>231
</span><span class=lnt>232
</span><span class=lnt>233
</span><span class=lnt>234
</span><span class=lnt>235
</span><span class=lnt>236
</span><span class=lnt>237
</span><span class=lnt>238
</span><span class=lnt>239
</span><span class=lnt>240
</span><span class=lnt>241
</span><span class=lnt>242
</span><span class=lnt>243
</span><span class=lnt>244
</span><span class=lnt>245
</span><span class=lnt>246
</span><span class=lnt>247
</span><span class=lnt>248
</span><span class=lnt>249
</span><span class=lnt>250
</span><span class=lnt>251
</span><span class=lnt>252
</span><span class=lnt>253
</span><span class=lnt>254
</span><span class=lnt>255
</span><span class=lnt>256
</span><span class=lnt>257
</span><span class=lnt>258
</span><span class=lnt>259
</span><span class=lnt>260
</span><span class=lnt>261
</span><span class=lnt>262
</span><span class=lnt>263
</span><span class=lnt>264
</span><span class=lnt>265
</span><span class=lnt>266
</span><span class=lnt>267
</span><span class=lnt>268
</span><span class=lnt>269
</span><span class=lnt>270
</span><span class=lnt>271
</span><span class=lnt>272
</span><span class=lnt>273
</span><span class=lnt>274
</span><span class=lnt>275
</span><span class=lnt>276
</span><span class=lnt>277
</span><span class=lnt>278
</span><span class=lnt>279
</span><span class=lnt>280
</span><span class=lnt>281
</span><span class=lnt>282
</span><span class=lnt>283
</span><span class=lnt>284
</span><span class=lnt>285
</span><span class=lnt>286
</span><span class=lnt>287
</span><span class=lnt>288
</span><span class=lnt>289
</span><span class=lnt>290
</span><span class=lnt>291
</span><span class=lnt>292
</span><span class=lnt>293
</span><span class=lnt>294
</span><span class=lnt>295
</span><span class=lnt>296
</span><span class=lnt>297
</span><span class=lnt>298
</span><span class=lnt>299
</span><span class=lnt>300
</span><span class=lnt>301
</span><span class=lnt>302
</span><span class=lnt>303
</span><span class=lnt>304
</span><span class=lnt>305
</span><span class=lnt>306
</span><span class=lnt>307
</span><span class=lnt>308
</span><span class=lnt>309
</span><span class=lnt>310
</span><span class=lnt>311
</span><span class=lnt>312
</span><span class=lnt>313
</span><span class=lnt>314
</span><span class=lnt>315
</span><span class=lnt>316
</span><span class=lnt>317
</span><span class=lnt>318
</span><span class=lnt>319
</span><span class=lnt>320
</span><span class=lnt>321
</span><span class=lnt>322
</span><span class=lnt>323
</span><span class=lnt>324
</span><span class=lnt>325
</span><span class=lnt>326
</span><span class=lnt>327
</span><span class=lnt>328
</span><span class=lnt>329
</span><span class=lnt>330
</span><span class=lnt>331
</span><span class=lnt>332
</span><span class=lnt>333
</span><span class=lnt>334
</span><span class=lnt>335
</span><span class=lnt>336
</span><span class=lnt>337
</span><span class=lnt>338
</span><span class=lnt>339
</span><span class=lnt>340
</span><span class=lnt>341
</span><span class=lnt>342
</span><span class=lnt>343
</span><span class=lnt>344
</span><span class=lnt>345
</span><span class=lnt>346
</span><span class=lnt>347
</span><span class=lnt>348
</span><span class=lnt>349
</span><span class=lnt>350
</span><span class=lnt>351
</span><span class=lnt>352
</span><span class=lnt>353
</span><span class=lnt>354
</span><span class=lnt>355
</span><span class=lnt>356
</span><span class=lnt>357
</span><span class=lnt>358
</span><span class=lnt>359
</span><span class=lnt>360
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-cpp data-lang=cpp><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;cstdio&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;unordered_map&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define endl &#39;\n&#39;
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>f64</span> <span class=o>=</span> <span class=kt>double</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>str</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>string</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>MAP_SI</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>unordered_map</span><span class=o>&lt;</span><span class=n>str</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>using</span> <span class=n>MAP_II</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>unordered_map</span><span class=o>&lt;</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=o>&gt;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// 固定的加成数值
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=k>const</span> <span class=n>f64</span> <span class=n>LOC_BOOST</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mf>1.25</span><span class=p>,</span> <span class=mf>1.00</span><span class=p>,</span> <span class=mf>0.75</span><span class=p>,</span> <span class=mf>0.00</span><span class=p>,</span> <span class=mf>0.75</span><span class=p>,</span> <span class=mf>1.00</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>f64</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=mi>3</span><span class=p>]</span> <span class=o>=</span> <span class=p>{{</span><span class=mf>1.0</span><span class=p>,</span> <span class=mf>0.9</span><span class=p>,</span> <span class=mf>1.1</span><span class=p>},</span> <span class=p>{</span><span class=mf>1.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>,</span> <span class=mf>0.9</span><span class=p>},</span> <span class=p>{</span><span class=mf>0.9</span><span class=p>,</span> <span class=mf>1.1</span><span class=p>,</span> <span class=mf>1.0</span><span class=p>}};</span>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=kt>int</span> <span class=n>PLACE</span><span class=p>[</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>5</span><span class=p>,</span> <span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=mi>4</span><span class=p>,</span> <span class=mi>6</span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>f64</span> <span class=n>ACT_SKL_MUL</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=mf>0.00</span><span class=p>,</span> <span class=mf>0.10</span><span class=p>,</span> <span class=mf>0.12</span><span class=p>,</span> <span class=mf>0.15</span><span class=p>,</span> <span class=mf>0.17</span><span class=p>,</span> <span class=mf>0.20</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=mf>0.00</span><span class=p>,</span> <span class=mf>0.06</span><span class=p>,</span> <span class=mf>0.07</span><span class=p>,</span> <span class=mf>0.08</span><span class=p>,</span> <span class=mf>0.09</span><span class=p>,</span> <span class=mf>0.10</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=mf>1.00</span><span class=p>,</span> <span class=mf>2.10</span><span class=p>,</span> <span class=mf>2.17</span><span class=p>,</span> <span class=mf>2.24</span><span class=p>,</span> <span class=mf>2.32</span><span class=p>,</span> <span class=mf>2.40</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>const</span> <span class=n>f64</span> <span class=n>PSV_SKL_MUL</span><span class=p>[</span><span class=mi>3</span><span class=p>][</span><span class=mi>6</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=mf>0.00</span><span class=p>,</span> <span class=mf>0.013</span><span class=p>,</span> <span class=mf>0.016</span><span class=p>,</span> <span class=mf>0.019</span><span class=p>,</span> <span class=mf>0.022</span><span class=p>,</span> <span class=mf>0.025</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=mf>0.00</span><span class=p>,</span> <span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.02</span><span class=p>,</span> <span class=mf>0.03</span><span class=p>,</span> <span class=mf>0.04</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>{</span><span class=mf>0.00</span><span class=p>,</span> <span class=mf>0.01</span><span class=p>,</span> <span class=mf>0.02</span><span class=p>,</span> <span class=mf>0.03</span><span class=p>,</span> <span class=mf>0.04</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>f64</span> <span class=n>atk_boost</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>f64</span> <span class=n>def_boost</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>1</span><span class=p>};</span>
</span></span><span class=line><span class=cl><span class=n>MAP_SI</span> <span class=n>WEAPON_TYPE</span> <span class=o>=</span> <span class=p>{{</span><span class=s>&#34;B&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>},</span> <span class=p>{</span><span class=s>&#34;G&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>},</span> <span class=p>{</span><span class=s>&#34;M&#34;</span><span class=p>,</span> <span class=mi>2</span><span class=p>}};</span>
</span></span><span class=line><span class=cl><span class=n>MAP_SI</span> <span class=n>PLAYER_TYPE</span> <span class=o>=</span> <span class=p>{{</span><span class=s>&#34;Weak&#34;</span><span class=p>,</span> <span class=mi>0</span><span class=p>},</span> <span class=p>{</span><span class=s>&#34;Average&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>},</span> <span class=p>{</span><span class=s>&#34;Strong&#34;</span><span class=p>,</span> <span class=mi>2</span><span class=p>}};</span>
</span></span><span class=line><span class=cl><span class=n>MAP_II</span> <span class=n>INIT_INDEX</span> <span class=o>=</span> <span class=p>{{</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>},</span> <span class=p>{</span><span class=mi>2</span><span class=p>,</span> <span class=mi>3</span><span class=p>},</span> <span class=p>{</span><span class=mi>3</span><span class=p>,</span> <span class=mi>1</span><span class=p>},</span> <span class=p>{</span><span class=mi>4</span><span class=p>,</span> <span class=mi>4</span><span class=p>},</span> <span class=p>{</span><span class=mi>5</span><span class=p>,</span> <span class=mi>0</span><span class=p>},</span> <span class=p>{</span><span class=mi>6</span><span class=p>,</span> <span class=mi>5</span><span class=p>}};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>member_cnt</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>round_cnt</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=n>attacker</span><span class=p>[</span><span class=mi>2</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>struct</span> <span class=nc>PLAYER</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>team_fr</span><span class=p>;</span> <span class=c1>// 归属队伍
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>team_id</span><span class=p>;</span> <span class=c1>// 归属队伍内编号
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>type</span><span class=p>;</span> <span class=c1>// 类型：0 = weak, 1 = average, 2 = strong
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>lvl</span><span class=p>;</span> <span class=c1>// 等级：1 ~ 100
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>f64</span> <span class=n>atk</span><span class=p>;</span> <span class=c1>// 基础攻击力
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>f64</span> <span class=n>def</span><span class=p>;</span> <span class=c1>// 基础防御力
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 体力上限
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>act_skl</span><span class=p>;</span> <span class=c1>// 主动技能等级：0 ~ 5
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>psv_skl</span><span class=p>;</span> <span class=c1>// 被动技能等级：0 ~ 5
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>weapon_type</span><span class=p>;</span> <span class=c1>// 武器类型：0 = B, 1 = G, 2 = M
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>f64</span> <span class=n>weapon_atk</span><span class=p>;</span> <span class=c1>// 武器攻击力
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>hp</span><span class=p>;</span> <span class=c1>// 当前体力
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>bool</span> <span class=n>status</span><span class=p>;</span> <span class=c1>// 状态：0 = dead, 1 = alive
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>f64</span> <span class=n>skl_boost</span><span class=p>;</span> <span class=c1>// 技能加成
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>dot_dmg</span><span class=p>;</span> <span class=c1>// 持续伤害大小
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>dot_rounds</span><span class=p>;</span> <span class=c1>// 持续伤害层数
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>input</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>player_type</span><span class=p>[</span><span class=mi>10</span><span class=p>],</span> <span class=n>weapon_type_t</span><span class=p>[</span><span class=mi>4</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%s Lv=%d maxhp=%d atk=%lf def=%lf skillLv=%d passivesklLv=%d %s weaponatk=%lf</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>player_type</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>lvl</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>max_hp</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>atk</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>def</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>act_skl</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>psv_skl</span><span class=p>,</span> <span class=n>weapon_type_t</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>weapon_atk</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>hp</span> <span class=o>=</span> <span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 初始生命值为上限
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>status</span> <span class=o>=</span> <span class=nb>true</span><span class=p>;</span> <span class=c1>// 初始角色未倒下
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>skl_boost</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// 初始技能加成为 1
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>type</span> <span class=o>=</span> <span class=n>PLAYER_TYPE</span><span class=p>[</span><span class=n>str</span><span class=p>(</span><span class=n>player_type</span><span class=p>)];</span> <span class=c1>// 根据输入获取角色类型对应数字
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>weapon_type</span> <span class=o>=</span> <span class=n>WEAPON_TYPE</span><span class=p>[</span><span class=n>str</span><span class=p>(</span><span class=n>weapon_type_t</span><span class=p>)];</span> <span class=c1>// 根据输入获取武器类型对应数字
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>dot_rounds</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// 初始持续伤害剩余层数为 0
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>dot_dmg</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// 初始持续伤害大小为 0
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>deal_damage</span><span class=p>(</span><span class=kt>int</span><span class=p>,</span> <span class=kt>int</span><span class=p>,</span> <span class=n>f64</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>void</span> <span class=nf>DOT</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=p>}</span> <span class=n>team</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=mi>7</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>/// @brief 在每回合开始时及有角色倒下后重新计算被动伤害
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t 默认为 -1，有角色倒下；如果输入为 0 或 1，则代表 Weak 类型的被动技能生效的团队
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=nf>reapply_passive_skills</span><span class=p>(</span><span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>t</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 如果是开局，则需要使 Weak 类型的被动效果生效
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>f64</span> <span class=n>weak</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// 统计 Weak 被动叠加效果层数
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=n>t</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>status</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>                <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=c1>// 对于当前队伍中所有还活着的 Weak 类型角色
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=n>weak</span> <span class=o>+=</span> <span class=n>PSV_SKL_MUL</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>psv_skl</span><span class=p>];</span> <span class=c1>// 根据其等级叠加效果加成
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=n>weak</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>min</span><span class=p>(</span><span class=n>weak</span><span class=p>,</span> <span class=mf>0.05</span><span class=p>);</span> <span class=c1>// 考虑效果加成上限
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=n>t</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>status</span><span class=p>)</span> <span class=k>continue</span><span class=p>;</span> <span class=c1>// 已经倒下的角色就不用考虑了
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>heal</span> <span class=o>=</span> <span class=n>weak</span> <span class=o>*</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 计算回复量
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span> <span class=o>+=</span> <span class=n>heal</span><span class=p>;</span> <span class=c1>// 回复
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span> <span class=o>&gt;</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>max_hp</span><span class=p>)</span> <span class=c1>// 如果回复后超过生命上限
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span> <span class=o>=</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 则将生命值更改为上限
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>tmp</span> <span class=o>!=</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span><span class=p>)</span> <span class=c1>// 如果生命值有所变动，就需要输出
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%s %d recovered +%d hp -&gt; %d/%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                    <span class=p>(</span><span class=n>t</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>i</span><span class=p>,</span> <span class=n>heal</span><span class=p>,</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span><span class=p>,</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>max_hp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 对于其他两种类型，只需要在角色倒下后考虑被动技能分配情况即可
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>t</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>;</span> <span class=o>++</span><span class=n>t</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>f64</span> <span class=n>average</span> <span class=o>=</span> <span class=mi>0</span><span class=p>,</span> <span class=n>strong</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=c1>// 统计被动效果叠加层数
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=n>t</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>status</span><span class=p>)</span> <span class=c1>// 对于当前队伍中所有还活着的对应类型队员
</span></span></span><span class=line><span class=cl><span class=c1></span>                <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=c1>// 统计 Average 被动叠加层数
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=n>average</span> <span class=o>+=</span> <span class=n>PSV_SKL_MUL</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>psv_skl</span><span class=p>];</span>
</span></span><span class=line><span class=cl>                <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span> <span class=c1>// 统计 Strong 被动叠加层数
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=n>strong</span> <span class=o>+=</span> <span class=n>PSV_SKL_MUL</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>psv_skl</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 根据上限进行相应调整
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>average</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>min</span><span class=p>(</span><span class=n>average</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=n>strong</span> <span class=o>=</span> <span class=n>std</span><span class=o>::</span><span class=n>min</span><span class=p>(</span><span class=n>strong</span><span class=p>,</span> <span class=mf>0.1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 增加对应的防御加成、攻击加成的值
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>def_boost</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>=</span> <span class=n>average</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>atk_boost</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>=</span> <span class=n>strong</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>/// @brief 根据攻击强度对当前角色进行扣血
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t_a 攻击方队伍的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param act 攻击者在攻击方队伍内的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param eff 攻击强度
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=n>PLAYER</span><span class=o>::</span><span class=n>deal_damage</span><span class=p>(</span><span class=kt>int</span> <span class=n>t_a</span><span class=p>,</span> <span class=kt>int</span> <span class=n>act</span><span class=p>,</span> <span class=n>f64</span> <span class=n>eff</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>status</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span> <span class=c1>// 保险措施，如果已经倒下就不用考虑了
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>dmg</span> <span class=o>=</span> <span class=n>eff</span> <span class=o>/</span> <span class=p>(</span><span class=n>def</span> <span class=o>*</span> <span class=n>def_boost</span><span class=p>[</span><span class=n>team_fr</span><span class=p>]);</span> <span class=c1>// 计算攻击产生扣血的有效值
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>hp</span> <span class=o>-=</span> <span class=n>dmg</span><span class=p>;</span> <span class=c1>// 扣血
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=c1>// 如果扣血后角色生命值不高于 0，则该角色倒下
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>hp</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>hp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>status</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span> <span class=c1>// 设定角色状态为倒下
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>reapply_passive_skills</span><span class=p>();</span> <span class=c1>// 重新考虑被动技能
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%s %d took %d damage from %s %d -&gt; %d/%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=n>team_fr</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>team_id</span><span class=p>,</span> <span class=n>dmg</span><span class=p>,</span> <span class=p>(</span><span class=n>t_a</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>act</span><span class=p>,</span> <span class=n>hp</span><span class=p>,</span> <span class=n>max_hp</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>/// @brief DoT，即 Damage over Time，处理当前角色受到的 Average 类型的持续伤害
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=n>PLAYER</span><span class=o>::</span><span class=n>DOT</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>status</span><span class=p>)</span> <span class=k>return</span><span class=p>;</span> <span class=c1>// 保险措施，如果已经倒下就不用考虑了
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>dot_rounds</span><span class=p>)</span> <span class=p>{</span> <span class=c1>// 如果持续伤害层数不为 0
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=o>--</span><span class=n>dot_rounds</span><span class=p>,</span> <span class=n>hp</span> <span class=o>-=</span> <span class=n>dot_dmg</span><span class=p>;</span> <span class=c1>// 则触发一次持续伤害并减一层层数
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// 同上
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>hp</span> <span class=o>&lt;=</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>hp</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>status</span> <span class=o>=</span> <span class=nb>false</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>reapply_passive_skills</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%s %d took %d damage from skill -&gt; %d/%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=p>(</span><span class=n>team_fr</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>team_id</span><span class=p>,</span> <span class=n>dot_dmg</span><span class=p>,</span> <span class=n>hp</span><span class=p>,</span> <span class=n>max_hp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>/// @brief 计算每一回合攻击方队伍的攻击者
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t 攻击方队伍的编号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=nf>get_attacker</span><span class=p>(</span><span class=kt>int</span> <span class=n>t</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>do</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=o>++</span><span class=n>attacker</span><span class=p>[</span><span class=n>t</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>attacker</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>&gt;</span> <span class=n>member_cnt</span><span class=p>[</span><span class=n>t</span><span class=p>])</span> <span class=n>attacker</span><span class=p>[</span><span class=n>t</span><span class=p>]</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span> <span class=k>while</span> <span class=p>(</span><span class=o>!</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>attacker</span><span class=p>[</span><span class=n>t</span><span class=p>]].</span><span class=n>status</span><span class=p>);</span> <span class=c1>// 如果找到未倒下的角色就跳出循环
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// 由于题目保证所有操作合法，所以不用担心死循环
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>/// @brief 触发主动技能
</span></span></span><span class=line><span class=cl><span class=c1>/// @param act 释放技能者在释放技能方队伍内的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param trg 被释放技能者在被释放技能方队伍内的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t_a 释放技能方队伍的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t_b 被释放技能队伍的编号
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=nf>activate_active_skill</span><span class=p>(</span><span class=kt>int</span> <span class=n>act</span><span class=p>,</span> <span class=kt>int</span> <span class=n>trg</span><span class=p>,</span> <span class=kt>int</span> <span class=n>t_a</span><span class=p>,</span> <span class=kt>int</span> <span class=n>t_b</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 获取技能类型名以便输出
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>str</span> <span class=n>skl_type</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=n>skl_type</span> <span class=o>=</span> <span class=s>&#34;Weak&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=n>skl_type</span> <span class=o>=</span> <span class=s>&#34;Average&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span> <span class=n>skl_type</span> <span class=o>=</span> <span class=s>&#34;Strong&#34;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%s %d applied %s skill to %s %d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=n>t_a</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>act</span><span class=p>,</span> <span class=n>skl_type</span><span class=p>.</span><span class=n>c_str</span><span class=p>(),</span> <span class=p>(</span><span class=n>t_b</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>trg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 对于 Weak 类型的主动技能
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>tmp</span> <span class=o>=</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>hp</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>heal</span> <span class=o>=</span> <span class=n>ACT_SKL_MUL</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>act_skl</span><span class=p>]</span> <span class=o>*</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 计算回复量
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>hp</span> <span class=o>+=</span> <span class=n>heal</span><span class=p>;</span> <span class=c1>// 回复
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>hp</span> <span class=o>&gt;</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>max_hp</span><span class=p>)</span> <span class=c1>// 如果回复后超过生命上限
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>hp</span> <span class=o>=</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 则将生命值改为上限
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>tmp</span> <span class=o>!=</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>hp</span><span class=p>)</span> <span class=c1>// 如果生命值有所变动，就需要输出
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%s %d recovered +%d hp -&gt; %d/%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=p>(</span><span class=n>t_b</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>),</span> <span class=n>trg</span><span class=p>,</span> <span class=n>heal</span><span class=p>,</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>hp</span><span class=p>,</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>max_hp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 对于 Average 类型的主动技能
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>dot_rounds</span> <span class=o>=</span> <span class=mi>3</span><span class=p>;</span> <span class=c1>// 设持续伤害持续 3 层
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>dot_dmg</span> <span class=o>=</span> <span class=n>ACT_SKL_MUL</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>act_skl</span><span class=p>]</span> <span class=o>*</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>max_hp</span><span class=p>;</span> <span class=c1>// 计算持续伤害大小
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 对于 Strong 类型的主动技能
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>skl_boost</span> <span class=o>=</span> <span class=n>ACT_SKL_MUL</span><span class=p>[</span><span class=mi>2</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>act_skl</span><span class=p>];</span> <span class=c1>// 更改角色的技能加成
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>/// @brief 实施普通攻击和特殊攻击
</span></span></span><span class=line><span class=cl><span class=c1>/// @param atk_p 攻击位置
</span></span></span><span class=line><span class=cl><span class=c1>/// @param ddg_p 躲闪位置
</span></span></span><span class=line><span class=cl><span class=c1>/// @param act 攻击者在攻击方队伍内的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param trg 防御者在防御方队伍内的编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t_a 攻击方队伍编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param t_b 防御方队伍编号
</span></span></span><span class=line><span class=cl><span class=c1>/// @param type 攻击类型，-1 为普通攻击，0~2 为对应的特殊攻击
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kt>void</span> <span class=nf>perform_attack</span><span class=p>(</span><span class=kt>int</span> <span class=n>atk_p</span><span class=p>,</span> <span class=kt>int</span> <span class=n>ddg_p</span><span class=p>,</span> <span class=kt>int</span> <span class=n>act</span><span class=p>,</span> <span class=kt>int</span> <span class=n>trg</span><span class=p>,</span> <span class=kt>int</span> <span class=n>t_a</span><span class=p>,</span> <span class=kt>int</span> <span class=n>t_b</span><span class=p>,</span> <span class=kt>int</span> <span class=n>type</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// 由于 G 和 M 类型的种族加成对不同目标有不同的取值，所以预处理时不包含种族加成
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=n>f64</span> <span class=n>eff</span> <span class=o>=</span> <span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>atk</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>weapon_atk</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>skl_boost</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>        <span class=n>atk_boost</span><span class=p>[</span><span class=n>t_a</span><span class=p>]</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>        <span class=n>LOC_BOOST</span><span class=p>[(</span><span class=n>atk_p</span> <span class=o>-</span> <span class=n>ddg_p</span> <span class=o>+</span> <span class=mi>6</span><span class=p>)</span> <span class=o>%</span> <span class=mi>6</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 普通攻击
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>type</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// B 型特殊攻击
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>type</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=mf>1.25</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 预处理 G 和 M 类型特殊 AoE 攻击的范围
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>trg_l</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=n>trg_r</span> <span class=o>=</span> <span class=o>-</span><span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 西边第一个未倒下的角色
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>INIT_INDEX</span><span class=p>[</span><span class=n>trg</span><span class=p>]</span> <span class=o>-</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&gt;=</span> <span class=mi>0</span><span class=p>;</span> <span class=o>--</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>PLACE</span><span class=p>[</span><span class=n>i</span><span class=p>]].</span><span class=n>status</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>trg_l</span> <span class=o>=</span> <span class=n>PLACE</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 东边第一个未倒下的角色
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>INIT_INDEX</span><span class=p>[</span><span class=n>trg</span><span class=p>]</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>6</span><span class=p>;</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>PLACE</span><span class=p>[</span><span class=n>i</span><span class=p>]].</span><span class=n>status</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>trg_r</span> <span class=o>=</span> <span class=n>PLACE</span><span class=p>[</span><span class=n>i</span><span class=p>];</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// G 型特殊攻击
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>if</span> <span class=p>(</span><span class=n>type</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>cand_cnt</span> <span class=o>=</span> <span class=p>(</span><span class=n>trg_l</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=p>(</span><span class=n>trg_r</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>f64</span> <span class=n>mul</span> <span class=o>=</span> <span class=mf>1.35</span> <span class=o>/</span> <span class=n>cand_cnt</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=n>mul</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>trg_l</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_l</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=n>mul</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_l</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>trg_r</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_r</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=n>mul</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_r</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// M 型特殊攻击
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>type</span> <span class=o>==</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=mf>1.15</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>trg_l</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_l</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=mf>0.23</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_l</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>trg_r</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_r</span><span class=p>].</span><span class=n>deal_damage</span><span class=p>(</span><span class=n>t_a</span><span class=p>,</span> <span class=n>act</span><span class=p>,</span> <span class=mf>0.23</span> <span class=o>*</span> <span class=n>eff</span> <span class=o>*</span> <span class=n>TYPE_BOOST</span><span class=p>[</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>act</span><span class=p>].</span><span class=n>type</span><span class=p>][</span><span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>trg_r</span><span class=p>].</span><span class=n>type</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d %d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>member_cnt</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=o>&amp;</span><span class=n>member_cnt</span><span class=p>[</span><span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 输入南队队员
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=mi>0</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>input</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>team_fr</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>team_id</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 输入北队队员
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=mi>1</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>input</span><span class=p>();</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>team_fr</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>team</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>team_id</span> <span class=o>=</span> <span class=n>i</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%d</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>round_cnt</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>RND</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>RND</span> <span class=o>&lt;=</span> <span class=n>round_cnt</span><span class=p>;</span> <span class=o>++</span><span class=n>RND</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>t_a</span> <span class=o>=</span> <span class=p>(</span><span class=n>RND</span> <span class=o>%</span> <span class=mi>2</span><span class=p>)</span> <span class=o>^</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// 计算攻击方队伍
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=kt>int</span> <span class=n>t_b</span> <span class=o>=</span> <span class=p>(</span><span class=n>RND</span> <span class=o>%</span> <span class=mi>2</span><span class=p>);</span> <span class=c1>// 计算防御方队伍
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl>        <span class=c1>// 对攻击方队伍施放 Weak 类型被动技能
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>reapply_passive_skills</span><span class=p>(</span><span class=n>t_a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 获取攻击方队伍的当前攻击者
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=n>get_attacker</span><span class=p>(</span><span class=n>t_a</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>active</span> <span class=o>=</span> <span class=n>attacker</span><span class=p>[</span><span class=n>t_a</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=kt>char</span> <span class=n>action_type</span><span class=p>[</span><span class=mi>20</span><span class=p>];</span>
</span></span><span class=line><span class=cl>        <span class=kt>int</span> <span class=n>trg</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;%s target=%d &#34;</span><span class=p>,</span> <span class=n>action_type</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>trg</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 施放普通攻击
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>if</span> <span class=p>(</span><span class=n>str</span><span class=p>(</span><span class=n>action_type</span><span class=p>)</span> <span class=o>==</span> <span class=s>&#34;Basicattack&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>atk_p</span><span class=p>,</span> <span class=n>ddg_p</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;atkpos=%d ddgpos=%d </span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>atk_p</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>ddg_p</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>perform_attack</span><span class=p>(</span><span class=n>atk_p</span><span class=p>,</span> <span class=n>ddg_p</span><span class=p>,</span> <span class=n>active</span><span class=p>,</span> <span class=n>trg</span><span class=p>,</span> <span class=n>t_a</span><span class=p>,</span> <span class=n>t_b</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>active</span><span class=p>].</span><span class=n>skl_boost</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// 施放攻击之后重置技能加成
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 施放特殊攻击
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>str</span><span class=p>(</span><span class=n>action_type</span><span class=p>)</span> <span class=o>==</span> <span class=s>&#34;Specialattack&#34;</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=kt>int</span> <span class=n>atk_p</span><span class=p>,</span> <span class=n>ddg_p</span><span class=p>;</span>
</span></span><span class=line><span class=cl>            <span class=n>scanf</span><span class=p>(</span><span class=s>&#34;atkpos=%d ddgpos=%d </span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>atk_p</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>ddg_p</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>perform_attack</span><span class=p>(</span><span class=n>atk_p</span><span class=p>,</span> <span class=n>ddg_p</span><span class=p>,</span> <span class=n>active</span><span class=p>,</span> <span class=n>trg</span><span class=p>,</span> <span class=n>t_a</span><span class=p>,</span> <span class=n>t_b</span><span class=p>,</span> <span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>active</span><span class=p>].</span><span class=n>weapon_type</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>active</span><span class=p>].</span><span class=n>skl_boost</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=c1>// 施放攻击之后重置技能加成
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 施放主动技能
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>str</span><span class=p>(</span><span class=n>action_type</span><span class=p>)</span> <span class=o>==</span> <span class=s>&#34;Skill&#34;</span><span class=p>)</span> <span class=c1>// 只有 Average 类型的主动技能是对敌方的
</span></span></span><span class=line><span class=cl><span class=c1></span>            <span class=n>activate_active_skill</span><span class=p>(</span><span class=n>active</span><span class=p>,</span> <span class=n>trg</span><span class=p>,</span> <span class=n>t_a</span><span class=p>,</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t_a</span><span class=p>][</span><span class=n>active</span><span class=p>].</span><span class=n>type</span> <span class=o>==</span> <span class=mi>1</span> <span class=o>?</span> <span class=nl>t_b</span> <span class=p>:</span> <span class=n>t_a</span><span class=p>));</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 对防守方队伍中所有收到持续伤害的队员结算持续伤害（同队施放的持续伤害只在同队为攻击方的回合内生效）
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=n>t_b</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>team</span><span class=p>[</span><span class=n>t_b</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>DOT</span><span class=p>();</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>// 先输出北队，再输出南队
</span></span></span><span class=line><span class=cl><span class=c1></span>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=o>~</span><span class=n>t</span><span class=p>;</span> <span class=o>--</span><span class=n>t</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%s: &#34;</span><span class=p>,</span> <span class=n>t</span> <span class=o>?</span> <span class=s>&#34;North&#34;</span> <span class=o>:</span> <span class=s>&#34;South&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>6</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=p>(</span><span class=n>PLACE</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=n>t</span><span class=p>])</span> <span class=c1>// 如果队伍不足 6 人就不输出对应位置的生命值
</span></span></span><span class=line><span class=cl><span class=c1></span>                    <span class=n>printf</span><span class=p>(</span><span class=s>&#34;%d/%d &#34;</span><span class=p>,</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>PLACE</span><span class=p>[</span><span class=n>i</span><span class=p>]].</span><span class=n>hp</span><span class=p>,</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>PLACE</span><span class=p>[</span><span class=n>i</span><span class=p>]].</span><span class=n>max_hp</span><span class=p>);</span>
</span></span><span class=line><span class=cl>            <span class=n>putchar</span><span class=p>(</span><span class=sc>&#39;\n&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>        <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>putchar</span><span class=p>(</span><span class=sc>&#39;\n&#39;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// 统计是否有队伍获胜
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=kt>int</span> <span class=n>alive_cnt</span><span class=p>[</span><span class=mi>2</span><span class=p>]</span> <span class=o>=</span> <span class=p>{</span><span class=mi>0</span><span class=p>,</span> <span class=mi>0</span><span class=p>};</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>t</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>t</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>;</span> <span class=o>++</span><span class=n>t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>1</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=n>member_cnt</span><span class=p>[</span><span class=n>t</span><span class=p>];</span> <span class=o>++</span><span class=n>i</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=p>(</span><span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>status</span> <span class=o>||</span> <span class=n>team</span><span class=p>[</span><span class=n>t</span><span class=p>][</span><span class=n>i</span><span class=p>].</span><span class=n>hp</span><span class=p>)</span>
</span></span><span class=line><span class=cl>                <span class=o>++</span><span class=n>alive_cnt</span><span class=p>[</span><span class=n>t</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>alive_cnt</span><span class=p>[</span><span class=mi>0</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>puts</span><span class=p>(</span><span class=s>&#34;Team North won.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>alive_cnt</span><span class=p>[</span><span class=mi>1</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=n>puts</span><span class=p>(</span><span class=s>&#34;Team South won.&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>fflush</span><span class=p>(</span><span class=n>stdout</span><span class=p>),</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div></details><h2 id=tips>Tips</h2><p>写这道题让我获得了许多写模拟的心得，下面简单说几条我觉得比较重要的。</p><ul><li>对于纯模拟题，一定要保证关键信息的可获取性。简单来说，在任何环境下，你都一定要保留至少一种查询到你所需要的信息的方式。它决定了我们需要维护什么东西。</li><li>保证代码可读。平时写 OI 题那种只有一个字母的变量名尽量少出现，多写注释，要让自己时刻清楚自己在写什么代码、实现什么功能，不被大量的信息冲昏头脑。</li><li>善用 Ctrl/Cmd + F 查找。像本题这种，同样一种属性可能在很多地方被影响或者影响其他数值的情况，最好用浏览器或 PDF 阅读器的查找功能找到某一个属性在题目表述中所有出现的地方，确保自己考虑周全了。</li></ul><h2 id=epilogue>Epilogue</h2><p>感谢你看到这里。这份代码或许不是最为简洁、最有效率的一份代码，但我依然希望你在完成这道题、阅读这篇题解的过程中有所收获。毕竟，正如出题人提供的的大样例成为我 AC 这道题的道路上一份有力的援助一样，写出这道题也一定是我们锻炼自己编码能力和调试能力、最终成为一名优秀的程序员的路途中一次十分有价值的经历吧。与你共勉。</p></section><footer class=article-footer><section class=article-tags><a href=/tags/%E6%A8%A1%E6%8B%9F/>模拟</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg>
<span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><footer class=site-footer><section class=copyright>&copy;
2024 Eoin Lee's Blog</section><section class=powerby>使用 <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> 构建<br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.26.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z+KMkF24hUW8WePSA9HM=" crossorigin=anonymous></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const e=document.createElement("link");e.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",e.type="text/css",e.rel="stylesheet",document.head.appendChild(e)})()</script></body></html>